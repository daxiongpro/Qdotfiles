#!/bin/bash
qtool(){
  if [ "$1" = "ip" ];then
    ifconfig | grep -Eo 'inet (addr:)?([0-9]*\.){3}[0-9]*' | grep -Eo '([0-9]*\.){3}[0-9]*' | grep -v '127.0.0.1' | grep -Ev '172.*.0.1'
  elif [ "$1" = "hs" ];then
	shift
	hserver $@
  else
    echo "Usage:"
    echo "  qtool [ip|ps]"
  fi
}
hserver(){
	port=${1-8080}
	ip=`qtool ip`
	python -m http.server $port --bind ${ip}
}

common_aliases () {
    alias ei="vim ~/.Qdotfiles/scripts/init.sh"
    alias q="qdot"
    alias sb="source ~/.zshrc"
    alias eb="vim ~/.zshrc"
    alias cz="cd ~/.Qdotfiles/zsh/"
    alias cq="cd ~/.Qdotfiles/"
    alias start="nautilus"
    alias wn="watch -n 1 nvidia-smi"
    alias cinit="cd ~/.Qdotfiles/scripts/init_a_fresh_ubuntu"
    alias nrst="sudo /etc/init.d/networking restart" # network restart 修改host后生效
    alias dsq="docker start qdot1804nvidia"
    alias deq="docker exec -it qdot1804nvidia /bin/zsh"
    alias pycharm="sh /opt/pycharm-2022.2/bin/pycharm.sh"
}


common_aliases

# 系统特有的环境变量
if test "$(expr substr $(uname -s) 1 5)" = "Linux"
then

	#CUDA
	if [ -d "/usr/local/cuda/bin" ];then
		export PATH=/usr/local/cuda/bin${PATH:+:${PATH}}
		export LD_LIBRARY_PATH=/usr/local/cuda/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}
	fi
	#homebrew
	if [ -d /home/linuxbrew/.linuxbrew/ ];then
		eval $(/home/linuxbrew/.linuxbrew/bin/brew shellenv)
	fi
fi
